<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Models &mdash; Waste Detection System 0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Training" href="waste_detection_system-training.html" />
    <link rel="prev" title="Entry Point: main" href="waste_detection_system-entry_point.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Waste Detection System
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="waste_detection_system.html">Waste Detection System</a></li>
<li class="toctree-l1"><a class="reference internal" href="waste_detection_system-entry_point.html">Entry point of the module</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Available models</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="waste_detection_system-training.html">Training scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="waste_detection_system-utils.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="waste_detection_system-constants.html">Constants</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Waste Detection System</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Models</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/waste_detection_system-models.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="models">
<h1>Models<a class="headerlink" href="#models" title="Permalink to this heading"></a></h1>
<div class="toctree-wrapper compound">
</div>
<section id="module-waste_detection_system.models">
<span id="object-detection-models"></span><h2>Object detection models<a class="headerlink" href="#module-waste_detection_system.models" title="Permalink to this heading"></a></h2>
<p>Collection of allowed object detection models in the Waste Detection System,
as well as functions to freeze and unfreeze layers given a Transfer Learning Level,
a model creation factory for object detection models and hybrid Deep Learning
models.</p>
<dl>
<dt>Deep Learning object detection models</dt><dd><ul class="simple">
<li><p>Faster R-CNN : <a class="reference external" href="https://pytorch.org/vision/main/models/generated/torchvision.models.detection.fasterrcnn_resnet50_fpn.html#torchvision.models.detection.fasterrcnn_resnet50_fpn">Faster R-CNN Pytorch documentation</a></p></li>
<li><p>FCOS : <a class="reference external" href="https://pytorch.org/vision/main/models/generated/torchvision.models.detection.fcos_resnet50_fpn.html#torchvision.models.detection.fcos_resnet50_fpn">FCOS Pytorch documentation</a></p></li>
<li><p>RetinaNet : <a class="reference external" href="https://pytorch.org/vision/main/models/generated/torchvision.models.detection.retinanet_resnet50_fpn_v2.html#torchvision.models.detection.retinanet_resnet50_fpn_v2">RetinaNet Pytorch documentation</a></p></li>
<li><p>SSD : <a class="reference external" href="https://pytorch.org/vision/main/models/generated/torchvision.models.detection.ssd300_vgg16.html#torchvision.models.detection.ssd300_vgg16">SSD Pytorch documentation</a></p></li>
</ul>
</dd>
<dt>Hybrid Deep Learning/traditional Machine Learning models</dt><dd><p>It takes a Deep Learning object detection model (of the mentioned above) and
a traditional Machine Learning classifier of the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>k-Nearest Neighbors Classifier: <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsClassifier.html">scikit-learn documentation</a></p></li>
<li><p>SVM Classifier: <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.LinearSVC.html">scikit-learn documentation</a></p></li>
</ul>
</div></blockquote>
</dd>
</dl>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>To train a hybrid Deep Learning model, it is necessary to fully train the object
detector and only then, with the best weights saved, use it to create the feature
extractor of the hybrid model.</p>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="waste_detection_system.models.get_base_model">
<span class="sig-prename descclassname"><span class="pre">waste_detection_system.models.</span></span><span class="sig-name descname"><span class="pre">get_base_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chosen_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Models</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transfer_learning_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">FasterRCNN</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FCOS</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">SSD</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">RetinaNet</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/waste_detection_system/models.html#get_base_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#waste_detection_system.models.get_base_model" title="Permalink to this definition"></a></dt>
<dd><p>Constructs the given model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_classes</strong> (<em>int</em>) – number of classes</p></li>
<li><p><strong>chosen_model</strong> (<em>AVAILABLE_MODELS</em>) – selected model</p></li>
<li><p><strong>transfer_learning_level</strong> (<em>int</em>) – Transfer Learning Level. For more information, see <a class="reference internal" href="waste_detection_system.html#tll"><span class="std std-ref">here</span></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>constructed model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[FasterRCNN, FCOS, SSD, RetinaNet]</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if <code class="docutils literal notranslate"><span class="pre">chosen_model</span></code> is not amongst the available ones</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waste_detection_system.models.get_hybrid_model">
<span class="sig-prename descclassname"><span class="pre">waste_detection_system.models.</span></span><span class="sig-name descname"><span class="pre">get_hybrid_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chosen_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Models</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chosen_classifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Classifiers</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#waste_detection_system.feature_extractor.HybridDLModel" title="waste_detection_system.feature_extractor.HybridDLModel"><span class="pre">HybridDLModel</span></a></span></span><a class="reference internal" href="_modules/waste_detection_system/models.html#get_hybrid_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#waste_detection_system.models.get_hybrid_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waste_detection_system.models.load_partial_weights">
<span class="sig-prename descclassname"><span class="pre">waste_detection_system.models.</span></span><span class="sig-name descname"><span class="pre">load_partial_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">FasterRCNN</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FCOS</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">SSD</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">RetinaNet</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">FasterRCNN</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FCOS</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">SSD</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">RetinaNet</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/waste_detection_system/models.html#load_partial_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#waste_detection_system.models.load_partial_weights" title="Permalink to this definition"></a></dt>
<dd><p>Load the given weights in the model. If a layer is not present in the weights
and model, the weights regarding that layer won’t be loaded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Union</em><em>[</em><em>FasterRCNN</em><em>, </em><em>FCOS</em><em>, </em><em>SSD</em><em>, </em><em>RetinaNet</em><em>]</em>) – model to load the weights in</p></li>
<li><p><strong>weights</strong> (<em>Any</em>) – weights to load</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>model with the weights loaded</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[FasterRCNN, FCOS, SSD, RetinaNet]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waste_detection_system.models.pretty_summary">
<span class="sig-prename descclassname"><span class="pre">waste_detection_system.models.</span></span><span class="sig-name descname"><span class="pre">pretty_summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">FasterRCNN</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FCOS</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">SSD</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">RetinaNet</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/waste_detection_system/models.html#pretty_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#waste_detection_system.models.pretty_summary" title="Permalink to this definition"></a></dt>
<dd><p>Prints the summary of the model, showing 3 levels of depth and the trainable/total parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> (<em>Union</em><em>[</em><em>FasterRCNN</em><em>, </em><em>FCOS</em><em>, </em><em>SSD</em><em>, </em><em>RetinaNet</em><em>]</em>) – model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waste_detection_system.models.print_stats">
<span class="sig-prename descclassname"><span class="pre">waste_detection_system.models.</span></span><span class="sig-name descname"><span class="pre">print_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">FasterRCNN</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FCOS</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">SSD</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">RetinaNet</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transfer_learning_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/waste_detection_system/models.html#print_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#waste_detection_system.models.print_stats" title="Permalink to this definition"></a></dt>
<dd><p>Prints the trainable/total parameters of the model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Union</em><em>[</em><em>FasterRCNN</em><em>, </em><em>FCOS</em><em>, </em><em>SSD</em><em>, </em><em>RetinaNet</em><em>]</em>) – model</p></li>
<li><p><strong>transfer_learning_level</strong> (<em>int</em>) – Transfer Learning Level. For more information, see <a class="reference internal" href="waste_detection_system.html#tll"><span class="std std-ref">here</span></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waste_detection_system.models.to_feature_extractor">
<span class="sig-prename descclassname"><span class="pre">waste_detection_system.models.</span></span><span class="sig-name descname"><span class="pre">to_feature_extractor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">FasterRCNN</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FCOS</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">RetinaNet</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">SSD</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#waste_detection_system.feature_extractor.FeatureExtractor" title="waste_detection_system.feature_extractor.FeatureExtractor"><span class="pre">FeatureExtractor</span></a></span></span><a class="reference internal" href="_modules/waste_detection_system/models.html#to_feature_extractor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#waste_detection_system.models.to_feature_extractor" title="Permalink to this definition"></a></dt>
<dd><p>Wraps the given model in order to obtain the bounding boxes and feature maps associated</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> (<em>Union</em><em>[</em><em>FasterRCNN</em><em>, </em><em>FCOS</em><em>, </em><em>RetinaNet</em><em>, </em><em>SSD</em><em>]</em>) – model to use as feature extractor</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if the wrapper is not implemented for the given model type</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>wrapper that returns a dictionary of ‘bounding_boxes’ and ‘features’,
both of them being lists of tensors</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#waste_detection_system.feature_extractor.FeatureExtractor" title="waste_detection_system.feature_extractor.FeatureExtractor">FeatureExtractor</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-waste_detection_system.feature_extractor">
<span id="hybrid-deep-learning-models"></span><h2>Hybrid Deep Learning models<a class="headerlink" href="#module-waste_detection_system.feature_extractor" title="Permalink to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the Hybrid Deep Learning models, the system requires that the user
previously trained the object detection module and applied the
corresponding weights.</p>
<p>The Hybrid Deep Learning model will <em>not</em> train the object detection module;
insted, when training the Machine Learning classifier the object detection
module will be put in <code class="docutils literal notranslate"><span class="pre">eval()</span></code> mode.</p>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="waste_detection_system.feature_extractor.FeatureExtractor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waste_detection_system.feature_extractor.</span></span><span class="sig-name descname"><span class="pre">FeatureExtractor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/waste_detection_system/feature_extractor.html#FeatureExtractor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#waste_detection_system.feature_extractor.FeatureExtractor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Intermediate module that transforms the object detection model into
a feature extractor that returns feature maps and bounding boxes.</p>
<dl class="py method">
<dt class="sig sig-object py" id="waste_detection_system.feature_extractor.FeatureExtractor.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/waste_detection_system/feature_extractor.html#FeatureExtractor.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#waste_detection_system.feature_extractor.FeatureExtractor.forward" title="Permalink to this definition"></a></dt>
<dd><p>Applies the input tensor to the model and retrieves the
results from the forward hook</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – input tensor</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>dictionary with <code class="docutils literal notranslate"><span class="pre">bounding_boxes</span></code> and</dt><dd><p><code class="docutils literal notranslate"><span class="pre">features</span></code> keys</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Dict[str, List[Tensor]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="waste_detection_system.feature_extractor.HybridDLModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waste_detection_system.feature_extractor.</span></span><span class="sig-name descname"><span class="pre">HybridDLModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_extractor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#waste_detection_system.feature_extractor.FeatureExtractor" title="waste_detection_system.feature_extractor.FeatureExtractor"><span class="pre">FeatureExtractor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Classifiers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/waste_detection_system/feature_extractor.html#HybridDLModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#waste_detection_system.feature_extractor.HybridDLModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Hybrid Deep Learning/traditional Machine Learning model that uses the
Deep Learning object detector model to obtain the bounding boxes and
the feature maps associated, and a traditional Machine Learning
classifier algorithm to predict the bounding box class given its
feature map.</p>
<dl class="py method">
<dt class="sig sig-object py" id="waste_detection_system.feature_extractor.HybridDLModel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_loader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataLoader</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="waste_detection_system-training.html#waste_detection_system.waste_detection_dataset.WasteDetectionDataset" title="waste_detection_system.waste_detection_dataset.WasteDetectionDataset"><span class="pre">WasteDetectionDataset</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_loader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataLoader</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="waste_detection_system-training.html#waste_detection_system.waste_detection_dataset.WasteDetectionDataset" title="waste_detection_system.waste_detection_dataset.WasteDetectionDataset"><span class="pre">WasteDetectionDataset</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/waste_detection_system/feature_extractor.html#HybridDLModel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#waste_detection_system.feature_extractor.HybridDLModel.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_loader</strong> (<em>Union</em><em>[</em><em>DataLoader</em><em>[</em><a class="reference internal" href="waste_detection_system-training.html#waste_detection_system.waste_detection_dataset.WasteDetectionDataset" title="waste_detection_system.waste_detection_dataset.WasteDetectionDataset"><em>WasteDetectionDataset</em></a><em>]</em><em>, </em><em>None</em><em>]</em>) – dataloader for
training. It won’t be used if the model is not in training mode. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>val_loader</strong> (<em>Union</em><em>[</em><em>DataLoader</em><em>[</em><a class="reference internal" href="waste_detection_system-training.html#waste_detection_system.waste_detection_dataset.WasteDetectionDataset" title="waste_detection_system.waste_detection_dataset.WasteDetectionDataset"><em>WasteDetectionDataset</em></a><em>]</em><em>, </em><em>None</em><em>]</em>) – dataloader for
validating. It won’t be used if the model is in training mode. Defaultos to <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>the output from the model.</dt><dd><p>During training, it returns the classifier loss.
During testing, it returns a list of dictionaries (one for each image) that contains
<code class="docutils literal notranslate"><span class="pre">boxes</span></code>, <code class="docutils literal notranslate"><span class="pre">labels</span></code>, <code class="docutils literal notranslate"><span class="pre">scores</span></code>.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>result (List[Dict[str, Tensor]])</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>Exception</strong> – if the model is training but train_loader is None or the model is not training
    but val_loader is None.
    The function will also raise an exception if the feature extractor can’t make
    any valid predictions.</p></li>
<li><p><strong>NotFittedError</strong> – if the model is in eval() mode but hasn’t been fitted beforehand.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waste_detection_system.feature_extractor.HybridDLModel.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/waste_detection_system/feature_extractor.html#HybridDLModel.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#waste_detection_system.feature_extractor.HybridDLModel.validate" title="Permalink to this definition"></a></dt>
<dd><p>Custom validation step to be used in conjunction with the model in <code class="docutils literal notranslate"><span class="pre">eval()</span></code> mode</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>List</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>Tensor</em><em>]</em><em>]</em>) – results from the <code class="docutils literal notranslate"><span class="pre">forward()</span></code> function in <code class="docutils literal notranslate"><span class="pre">eval()</span></code> mode</p></li>
<li><p><strong>y</strong> (<em>List</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>Tensor</em><em>]</em><em>]</em>) – targets, as passed to the <code class="docutils literal notranslate"><span class="pre">forward()</span></code> function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>dictionary with only one key <code class="docutils literal notranslate"><span class="pre">classification_loss</span></code> that holds the</dt><dd><p>classification loss</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Dict[str, Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="waste_detection_system-entry_point.html" class="btn btn-neutral float-left" title="Entry Point: main" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="waste_detection_system-training.html" class="btn btn-neutral float-right" title="Training" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Patricia Lázaro Tello.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>